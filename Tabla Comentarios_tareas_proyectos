-- Crea la tabla
CREATE TABLE COMENTARIOS_TAREAS_PROYECTOS (
    ID             NUMBER,
    ID_TAREA              NUMBER,
    COMENTARIO VARCHAR2(4000),
    FECHACOMENTARIO DATE
);

-- Crea la secuencia
CREATE SEQUENCE COMENTARIOS_TAREAS_PROYECTOS_SEQ1
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;


CREATE OR REPLACE EDITIONABLE TRIGGER COMENTARIOS_TAREAS_PROYECTOS_TRG
BEFORE INSERT ON COMENTARIOS_TAREAS_PROYECTOS 
FOR EACH ROW 
BEGIN
  IF INSERTING AND :NEW.ID IS NULL THEN
    SELECT COMENTARIOS_TAREAS_PROYECTOS_SEQ1.NEXTVAL INTO :NEW.ID FROM SYS.DUAL;
  END IF;
END;
/

-- Activa la secuencia
ALTER TRIGGER COMENTARIOS_TAREAS_PROYECTOS_TRG ENABLE;

-- Verifica que esxista
SELECT trigger_name, status
FROM user_triggers
WHERE trigger_name = 'COMENTARIOS_TAREAS_PROYECTOS_TRG';
